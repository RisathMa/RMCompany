<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>File Converter</title><style>:root{--primary-color:#3498db;--secondary-color:#2980b9;--accent-color:#e74c3c;--light-bg:#f5f7fa;--dark-bg:#2c3e50;--text-color:#333;--light-text:#fff;--border-radius:8px;--box-shadow:0 4px 6px rgba(0,0,0,0.1);--transition:all 0.3s ease}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}body{background-color:var(--light-bg);color:var(--text-color);line-height:1.6;padding:20px}.container{max-width:1000px;margin:0 auto;padding:20px}header{text-align:center;margin-bottom:30px}h1{color:var(--dark-bg);font-size:2.5rem;margin-bottom:10px}.subtitle{color:var(--secondary-color);font-size:1.2rem}.tabs{display:flex;background-color:white;border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--box-shadow);margin-bottom:20px}.tab-button{flex:1;padding:15px;background-color:white;border:none;cursor:pointer;font-size:1rem;font-weight:600;transition:var(--transition);color:var(--text-color)}.tab-button:hover{background-color:#f1f1f1}.tab-button.active{background-color:var(--primary-color);color:var(--light-text)}.tab-content{display:none;background-color:white;padding:30px;border-radius:var(--border-radius);box-shadow:var(--box-shadow);margin-bottom:20px}.tab-content.active{display:block}.converter-options{margin-bottom:20px}.option-group{margin-bottom:20px}label{display:block;margin-bottom:8px;font-weight:600}select,input[type="number"],input[type="text"]{width:100%;padding:10px;border:1px solid #ddd;border-radius:var(--border-radius);margin-bottom:15px;font-size:1rem}.drop-area{border:2px dashed #ddd;border-radius:var(--border-radius);padding:40px 20px;text-align:center;margin-bottom:20px;transition:var(--transition);background-color:#f9f9f9;cursor:pointer}.drop-area:hover,.drop-area.dragover{border-color:var(--primary-color);background-color:#f0f8ff}.drop-area p{margin-bottom:15px;font-size:1.1rem}.drop-area .icon{font-size:2.5rem;color:var(--primary-color);margin-bottom:15px}.file-info{display:none;margin-bottom:20px;padding:15px;border-radius:var(--border-radius);background-color:#e8f4fd}.file-info.visible{display:block}.file-info .file-name{font-weight:600;margin-bottom:5px}.button-group{display:flex;gap:10px}button{padding:12px 24px;border:none;border-radius:var(--border-radius);cursor:pointer;font-size:1rem;font-weight:600;transition:var(--transition)}.convert-btn{background-color:var(--primary-color);color:white;flex:1}.convert-btn:hover{background-color:var(--secondary-color)}.download-btn{background-color:#27ae60;color:white;flex:1;display:none}.download-btn.visible{display:block}.download-btn:hover{background-color:#219653}.clear-btn{background-color:#e74c3c;color:white}.clear-btn:hover{background-color:#c0392b}.progress-bar-container{height:10px;background-color:#eee;border-radius:5px;margin-bottom:20px;overflow:hidden;display:none}.progress-bar-container.visible{display:block}.progress-bar{height:100%;width:0;background-color:var(--primary-color);transition:width 0.3s ease}.status-message{text-align:center;margin-bottom:20px;font-weight:600;color:var(--secondary-color);min-height:24px}.error-message{color:var(--accent-color)}.text-editor{width:100%;height:300px;padding:15px;border:1px solid #ddd;border-radius:var(--border-radius);font-family:monospace;resize:vertical;margin-bottom:20px}.image-preview{max-width:100%;margin:20px auto;display:block;max-height:300px;border-radius:var(--border-radius);display:none}.image-preview.visible{display:block}.image-options{display:none}.image-options.visible{display:block}.resize-group{display:flex;align-items:center;gap:10px;margin-bottom:15px}.resize-group label{margin-bottom:0}.resize-group input{max-width:100px;margin-bottom:0}@media (max-width:768px){.tabs{flex-direction:column}.button-group{flex-direction:column}h1{font-size:2rem}.drop-area{padding:20px 10px}}footer{text-align:center;margin-top:30px;color:#777;font-size:0.9rem}.loader{display:inline-block;width:24px;height:24px;border:3px solid rgba(0,0,0,0.1);border-radius:50%;border-top-color:var(--primary-color);animation:spin 1s ease-in-out infinite;margin-right:8px;vertical-align:middle;display:none}.loader.visible{display:inline-block}@keyframes spin{to{transform:rotate(360deg)}}</style></head><body><div class="container"><header><h1>File Converter</h1><p class="subtitle">Convert files directly in your browser - no upload required</p></header><div class="tabs"><button class="tab-button active" data-tab="image">Image Converter</button><button class="tab-button" data-tab="document">Document Converter</button><button class="tab-button" data-tab="audio">Audio Converter</button></div><div id="image" class="tab-content active"><div class="converter-options"><div class="option-group"><label for="image-from">Convert from:</label><select id="image-from"><option value="jpg">JPG</option><option value="png">PNG</option><option value="webp">WEBP</option><option value="bmp">BMP</option></select></div><div class="option-group"><label for="image-to">Convert to:</label><select id="image-to"><option value="png">PNG</option><option value="jpg">JPG</option><option value="webp">WEBP</option><option value="bmp">BMP</option></select></div></div><div class="drop-area" id="image-drop-area"><div class="icon">üìÅ</div><p>Drag & drop image files here</p><p>- or -</p><input type="file" id="image-file-input" accept="image/jpeg,image/png,image/webp,image/bmp" style="display:none"><button class="convert-btn" id="image-browse-btn">Browse Files</button></div><div class="file-info" id="image-file-info"><p class="file-name" id="image-file-name"></p><p id="image-file-size"></p></div><img id="image-preview" class="image-preview" alt="Image Preview"><div class="image-options" id="image-options"><div class="option-group"><label><input type="checkbox" id="resize-checkbox"> Resize image before conversion</label><div id="resize-options" style="display:none;margin-top:10px;padding-left:15px"><div class="resize-group"><label for="width-input">Width:</label><input type="number" id="width-input" min="1" placeholder="Width in px"><span>px</span></div><div class="resize-group"><label for="height-input">Height:</label><input type="number" id="height-input" min="1" placeholder="Height in px"><span>px</span></div><label><input type="checkbox" id="maintain-aspect-ratio" checked> Maintain aspect ratio</label></div></div><div class="option-group" id="jpg-options" style="display:none"><label for="jpg-quality">JPEG Quality:</label><input type="range" id="jpg-quality" min="0" max="100" value="90"><span id="jpg-quality-value">90%</span></div><div class="option-group" id="webp-options" style="display:none"><label for="webp-quality">WebP Quality:</label><input type="range" id="webp-quality" min="0" max="100" value="80"><span id="webp-quality-value">80%</span></div></div><div class="progress-bar-container" id="image-progress-container"><div class="progress-bar" id="image-progress-bar"></div></div><div class="status-message" id="image-status"><span class="loader" id="image-loader"></span><span id="image-status-text"></span></div><div class="button-group"><button class="convert-btn" id="image-convert-btn" disabled>Convert</button><button class="download-btn" id="image-download-btn">Download</button><button class="clear-btn" id="image-clear-btn">Clear</button></div></div><div id="document" class="tab-content"><div class="converter-options"><div class="option-group"><label for="doc-conversion">Conversion Type:</label><select id="doc-conversion"><option value="txt-to-pdf">TXT to PDF</option><option value="html-to-txt">HTML to TXT</option><option value="txt-to-html">TXT to HTML</option><option value="docx-to-txt">DOCX to TXT</option></select></div></div><div id="document-type-txt-pdf"><div class="option-group"><label for="text-input">Enter text or</label><textarea id="text-input" class="text-editor" placeholder="Type or paste your text here..."></textarea><div class="drop-area" id="text-drop-area"><div class="icon">üìÑ</div><p>Drag & drop a text file here</p><p>- or -</p><input type="file" id="text-file-input" accept=".txt" style="display:none"><button class="convert-btn" id="text-browse-btn">Browse Files</button></div></div><div class="option-group" id="pdf-options"><label for="pdf-title">PDF Title (optional):</label><input type="text" id="pdf-title" placeholder="Enter document title"><label for="pdf-font-size">Font Size:</label><select id="pdf-font-size"><option value="10">10 pt</option><option value="12" selected>12 pt</option><option value="14">14 pt</option><option value="16">16 pt</option></select></div></div><div id="document-type-html" style="display:none"><div class="drop-area" id="html-drop-area"><div class="icon">üìÑ</div><p>Drag & drop an HTML file here</p><p>- or -</p><input type="file" id="html-file-input" accept=".html,.htm" style="display:none"><button class="convert-btn" id="html-browse-btn">Browse Files</button></div><div class="option-group"><textarea id="html-editor" class="text-editor" placeholder="Or paste your HTML here..."></textarea></div></div><div id="document-type-docx" style="display:none"><div class="drop-area" id="docx-drop-area"><div class="icon">üìÑ</div><p>Drag & drop a DOCX file here</p><p>- or -</p><input type="file" id="docx-file-input" accept=".docx" style="display:none"><button class="convert-btn" id="docx-browse-btn">Browse Files</button></div></div><div class="file-info" id="doc-file-info"><p class="file-name" id="doc-file-name"></p><p id="doc-file-size"></p></div><div class="progress-bar-container" id="doc-progress-container"><div class="progress-bar" id="doc-progress-bar"></div></div><div class="status-message" id="doc-status"><span class="loader" id="doc-loader"></span><span id="doc-status-text"></span></div><div class="button-group"><button class="convert-btn" id="doc-convert-btn" disabled>Convert</button><button class="download-btn" id="doc-download-btn">Download</button><button class="clear-btn" id="doc-clear-btn">Clear</button></div></div><div id="audio" class="tab-content"><div class="converter-options"><div class="option-group"><label for="audio-conversion">Conversion Type:</label><select id="audio-conversion"><option value="wav-to-mp3">WAV to MP3</option><option value="mp3-to-wav">MP3 to WAV</option></select></div></div><div class="drop-area" id="audio-drop-area"><div class="icon">üéµ</div><p>Drag & drop audio files here</p><p>- or -</p><input type="file" id="audio-file-input" accept="audio/wav,audio/mpeg" style="display:none"><button class="convert-btn" id="audio-browse-btn">Browse Files</button></div><div class="file-info" id="audio-file-info"><p class="file-name" id="audio-file-name"></p><p id="audio-file-size"></p></div><audio id="audio-player" controls style="width:100%;margin:20px 0;display:none"></audio><div class="option-group" id="mp3-options"><label for="mp3-bitrate">MP3 Bitrate:</label><select id="mp3-bitrate"><option value="128">128 kbps</option><option value="192" selected>192 kbps</option><option value="256">256 kbps</option><option value="320">320 kbps</option></select></div><div class="progress-bar-container" id="audio-progress-container"><div class="progress-bar" id="audio-progress-bar"></div></div><div class="status-message" id="audio-status"><span class="loader" id="audio-loader"></span><span id="audio-status-text"></span></div><div class="button-group"><button class="convert-btn" id="audio-convert-btn" disabled>Convert</button><button class="download-btn" id="audio-download-btn">Download</button><button class="clear-btn" id="audio-clear-btn">Clear</button></div></div><footer><p>This file converter works entirely in your browser. Your files never leave your device.</p></footer></div><script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js" onload="checkLibLoad('pdfmake')" onerror="alert('Failed to load pdfmake. Please check your internet connection or host the library locally.')"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js" onload="checkLibLoad('vfs_fonts')" onerror="alert('Failed to load vfs_fonts. Please check your internet connection or host the library locally.')"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lamejs/1.2.1/lame.min.js" onload="checkLibLoad('lamejs')" onerror="alert('Failed to load lamejs. Please check your internet connection or host the library locally.')"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js" onload="checkLibLoad('mammoth')" onerror="alert('Failed to load mammoth. Please check your internet connection or host the library locally.')"></script><script>let _libsLoaded=0;function checkLibLoad(lib){_libsLoaded++;if(_libsLoaded===4)console.log("All libraries loaded successfully.");else console.log(`${lib} loaded, ${_libsLoaded}/4 libraries ready.`)}function _fSz(b){return b<1024?`${b} B`:b<1048576?`${(b/1024).toFixed(2)} KB`:`${(b/1048576).toFixed(2)} MB`}function _sDAD(a,b,c){["dragenter","dragover","dragleave","drop"].forEach(d=>a.addEventListener(d,e=>{e.preventDefault();e.stopPropagation()}));a.addEventListener("dragenter",()=>a.classList.add("dragover"));a.addEventListener("dragover",()=>a.classList.add("dragover"));a.addEventListener("dragleave",()=>a.classList.remove("dragover"));a.addEventListener("drop",e=>{e.preventDefault();a.classList.remove("dragover");c(e.dataTransfer.files[0])})}document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelectorAll(".tab-button"),b=document.querySelectorAll(".tab-content");a.forEach(c=>c.addEventListener("click",()=>{a.forEach(d=>d.classList.remove("active"));b.forEach(d=>d.classList.remove("active"));c.classList.add("active");document.getElementById(c.getAttribute("data-tab")).classList.add("active")}));let c=null,d=null;const e=document.getElementById("image-drop-area"),f=document.getElementById("image-file-input"),g=document.getElementById("image-browse-btn"),h=document.getElementById("image-file-info"),i=document.getElementById("image-file-name"),j=document.getElementById("image-file-size"),k=document.getElementById("image-preview"),l=document.getElementById("image-options"),m=document.getElementById("image-convert-btn"),n=document.getElementById("image-download-btn"),o=document.getElementById("image-clear-btn"),p=document.getElementById("image-progress-container"),q=document.getElementById("image-progress-bar"),r=document.getElementById("image-status-text"),s=document.getElementById("image-loader"),t=document.getElementById("resize-checkbox"),u=document.getElementById("resize-options"),v=document.getElementById("width-input"),w=document.getElementById("height-input"),x=document.getElementById("maintain-aspect-ratio"),y=document.getElementById("image-from"),z=document.getElementById("image-to"),A=document.getElementById("jpg-options"),B=document.getElementById("webp-options"),C=document.getElementById("jpg-quality"),D=document.getElementById("jpg-quality-value"),E=document.getElementById("webp-quality"),F=document.getElementById("webp-quality-value");function G(a,b=false){r.textContent=a;r.classList.toggle("error-message",b);console.log(`Image: ${a}`)}function H(a){if(!a||!a.type.startsWith("image/")){G("Invalid image file.",true);return}const b=a.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png","webp","bmp"].includes(b)){G("Unsupported image format.",true);return}c=a;i.textContent=a.name;j.textContent=_fSz(a.size);h.classList.add("visible");const d=new FileReader();d.onload=e=>{k.src=e.target.result;k.classList.add("visible");const f=new Image();f.onload=()=>{v.value=f.width;w.value=f.height;x.checked=true};f.src=e.target.result;l.classList.add("visible");m.disabled=false;G("");const g=b==="jpeg"?"jpg":b;y.value=g};d.readAsDataURL(a)}_sDAD(e,f,H);g.addEventListener("click",()=>f.click());f.addEventListener("change",()=>{if(f.files[0])H(f.files[0])});t.addEventListener("change",()=>{u.style.display=t.checked?"block":"none"});v.addEventListener("input",()=>{if(x.checked&&v.value)w.value=Math.round(v.value*w.value/(v.value||1))});w.addEventListener("input",()=>{if(x.checked&&w.value)v.value=Math.round(w.value*v.value/(w.value||1))});C.addEventListener("input",()=>{D.textContent=`${C.value}%`});E.addEventListener("input",()=>{F.textContent=`${E.value}%`});z.addEventListener("change",()=>{A.style.display=z.value==="jpg"?"block":"none";B.style.display=z.value==="webp"?"block":"none"});async function I(){if(!c){G("No image selected.",true);return}p.classList.add("visible");q.style.width="0%";s.classList.add("visible");G("Converting...");try{const a=new Image();a.src=URL.createObjectURL(c);await new Promise(b=>a.onload=b);const d=document.createElement("canvas");let e=a.width,f=a.height;if(t.checked){e=parseInt(v.value)||e;f=parseInt(w.value)||f}d.width=e;d.height=f;const g=d.getContext("2d");g.drawImage(a,0,0,e,f);const h=z.value,i=h==="jpg"?(C.value/100):(h==="webp"?(E.value/100):1);for(let j=0;j<=100;j+=10){q.style.width=`${j}%`;await new Promise(k=>setTimeout(k,50))}d.toBlob(j=>{d=j;n.classList.add("visible");s.classList.remove("visible");G("Conversion complete!");URL.revokeObjectURL(a.src)},`image/${h==="jpg"?"jpeg":h}`,i)}catch(a){G(`Error: ${a.message}`,true);s.classList.remove("visible");p.classList.remove("visible");console.error("Image error:",a)}}function J(){if(!d)return;const a=URL.createObjectURL(d),b=document.createElement("a");b.href=a;b.download=`converted.${z.value}`;b.click();URL.revokeObjectURL(a)}function K(){c=null;d=null;f.value="";h.classList.remove("visible");k.classList.remove("visible");l.classList.remove("visible");m.disabled=true;n.classList.remove("visible");p.classList.remove("visible");q.style.width="0%";s.classList.remove("visible");G("");t.checked=false;u.style.display="none";v.value="";w.value=""}m.addEventListener("click",I);n.addEventListener("click",J);o.addEventListener("click",K);let L=null,M=null;const N=document.getElementById("doc-conversion"),O=document.getElementById("text-drop-area"),P=document.getElementById("text-file-input"),Q=document.getElementById("text-browse-btn"),R=document.getElementById("html-drop-area"),S=document.getElementById("html-file-input"),T=document.getElementById("html-browse-btn"),U=document.getElementById("docx-drop-area"),V=document.getElementById("docx-file-input"),W=document.getElementById("docx-browse-btn"),X=document.getElementById("text-input"),Y=document.getElementById("html-editor"),Z=document.getElementById("pdf-title"),_=document.getElementById("pdf-font-size"),aa=document.getElementById("doc-file-info"),ba=document.getElementById("doc-file-name"),ca=document.getElementById("doc-file-size"),da=document.getElementById("doc-progress-container"),ea=document.getElementById("doc-progress-bar"),fa=document.getElementById("doc-status-text"),ga=document.getElementById("doc-loader"),ha=document.getElementById("doc-convert-btn"),ia=document.getElementById("doc-download-btn"),ja=document.getElementById("doc-clear-btn");function ka(a,b=false){fa.textContent=a;fa.classList.toggle("error-message",b);console.log(`Document: ${a}`)}function la(){const a=N.value;document.getElementById("document-type-txt-pdf").style.display=a==="txt-to-pdf"?"block":"none";document.getElementById("document-type-html").style.display=["html-to-txt","txt-to-html"].includes(a)?"block":"none";document.getElementById("document-type-docx").style.display=a==="docx-to-txt"?"block":"none";aa.classList.remove("visible");ha.disabled=a!=="txt-to-pdf"||!X.value}function ma(a){if(!a){ka("No file selected.",true);return}const b=N.value,c=a.name.split(".").pop().toLowerCase();if(b==="txt-to-pdf"&&c!=="txt"){ka("Invalid TXT file.",true);return}if(["html-to-txt","txt-to-html"].includes(b)&&!["html","htm"].includes(c)){ka("Invalid HTML file.",true);return}if(b==="docx-to-txt"&&c!=="docx"){ka("Invalid DOCX file.",true);return}L=a;ba.textContent=a.name;ca.textContent=_fSz(a.size);aa.classList.add("visible");ha.disabled=false;ka("");if(b==="txt-to-pdf")a.text().then(d=>X.value=d);else if(["html-to-txt","txt-to-html"].includes(b))a.text().then(d=>Y.value=d)}_sDAD(O,P,ma);_sDAD(R,S,ma);_sDAD(U,V,ma);Q.addEventListener("click",()=>P.click());T.addEventListener("click",()=>S.click());W.addEventListener("click",()=>V.click());P.addEventListener("change",()=>{if(P.files[0])ma(P.files[0])});S.addEventListener("change",()=>{if(S.files[0])ma(S.files[0])});V.addEventListener("change",()=>{if(V.files[0])ma(V.files[0])});X.addEventListener("input",()=>{if(N.value==="txt-to-pdf")ha.disabled=!X.value});Y.addEventListener("input",()=>{if(N.value==="html-to-txt")ha.disabled=!Y.value});async function na(){const a=N.value;da.classList.add("visible");ea.style.width="0%";ga.classList.add("visible");ka("Converting...");try{if(a==="txt-to-pdf"){const b=X.value||(L?await L.text():"");if(!b)throw new Error("No text provided");const c={content:[{text:Z.value||"Converted Document",style:"header"},{text:b,style:"body"}],styles:{header:{fontSize:parseInt(_.value)+2,bold:true,margin:[0,0,0,10]},body:{fontSize:parseInt(_.value)}}};for(let d=0;d<=100;d+=10){ea.style.width=`${d}%`;await new Promise(e=>setTimeout(e,50))}pdfMake.createPdf(c).getBlob(d=>{M=d;ia.classList.add("visible");ga.classList.remove("visible");ka("Conversion complete!")})}else if(a==="html-to-txt"){const b=Y.value||(L?await L.text():"");if(!b)throw new Error("No HTML provided");const c=new DOMParser(),d=c.parseFromString(b,"text/html"),e=d.body.textContent||"";M=new Blob([e],{type:"text/plain"});for(let f=0;f<=100;f+=10){ea.style.width=`${f}%`;await new Promise(g=>setTimeout(g,50))}ia.classList.add("visible");ga.classList.remove("visible");ka("Conversion complete!")}else if(a==="txt-to-html"){const b=X.value||(L?await L.text():"");if(!b)throw new Error("No text provided");const c=`<!DOCTYPE html><html><head><title>Converted Document</title></head><body><pre>${b}</pre></body></html>`;M=new Blob([c],{type:"text/html"});for(let d=0;d<=100;d+=10){ea.style.width=`${d}%`;await new Promise(e=>setTimeout(e,50))}ia.classList.add("visible");ga.classList.remove("visible");ka("Conversion complete!")}else if(a==="docx-to-txt"){if(!L)throw new Error("No DOCX provided");const b=await L.arrayBuffer(),c=await mammoth.extractRawText({arrayBuffer:b});if(!c.value)throw new Error("Failed to extract text");M=new Blob([c.value],{type:"text/plain"});for(let d=0;d<=100;d+=10){ea.style.width=`${d}%`;await new Promise(e=>setTimeout(e,50))}ia.classList.add("visible");ga.classList.remove("visible");ka("Conversion complete!")}}catch(a){ka(`Error: ${a.message}`,true);ga.classList.remove("visible");da.classList.remove("visible");console.error("Document error:",a)}}function oa(){if(!M)return;const a=URL.createObjectURL(M),b=document.createElement("a"),c=N.value==="txt-to-pdf"?"pdf":(N.value==="txt-to-html"?"html":"txt");b.href=a;b.download=`converted.${c}`;b.click();URL.revokeObjectURL(a)}function pa(){L=null;M=null;P.value="";S.value="";V.value="";X.value="";Y.value="";Z.value="";aa.classList.remove("visible");ha.disabled=true;ia.classList.remove("visible");da.classList.remove("visible");ea.style.width="0%";ga.classList.remove("visible");ka("")}N.addEventListener("change",la);ha.addEventListener("click",na);ia.addEventListener("click",oa);ja.addEventListener("click",pa);la();let qa=null,ra=null;const sa=document.getElementById("audio-drop-area"),ta=document.getElementById("audio-file-input"),ua=document.getElementById("audio-browse-btn"),va=document.getElementById("audio-file-info"),wa=document.getElementById("audio-file-name"),xa=document.getElementById("audio-file-size"),ya=document.getElementById("audio-player"),za=document.getElementById("audio-conversion"),Aa=document.getElementById("mp3-options"),Ba=document.getElementById("mp3-bitrate"),Ca=document.getElementById("audio-progress-container"),Da=document.getElementById("audio-progress-bar"),Ea=document.getElementById("audio-status-text"),Fa=document.getElementById("audio-loader"),Ga=document.getElementById("audio-convert-btn"),Ha=document.getElementById("audio-download-btn"),Ia=document.getElementById("audio-clear-btn");function Ja(a,b=false){Ea.textContent=a;Ea.classList.toggle("error-message",b);console.log(`Audio: ${a}`)}function Ka(a){if(!a){Ja("No file selected.",true);return}const b=za.value,c=a.name.split(".").pop().toLowerCase();if(b==="wav-to-mp3"&&c!=="wav"){Ja("Invalid WAV file.",true);return}if(b==="mp3-to-wav"&&c!=="mp3"){Ja("Invalid MP3 file.",true);return}qa=a;wa.textContent=a.name;xa.textContent=_fSz(a.size);va.classList.add("visible");ya.src=URL.createObjectURL(a);ya.style.display="block";Ga.disabled=false;Ja("")}_sDAD(sa,ta,Ka);ua.addEventListener("click",()=>ta.click());ta.addEventListener("change",()=>{if(ta.files[0])Ka(ta.files[0])});za.addEventListener("change",()=>{Aa.style.display=za.value==="wav-to-mp3"?"block":"none";Ga.disabled=!qa});async function La(){if(!qa){Ja("No audio selected.",true);return}Ca.classList.add("visible");Da.style.width="0%";Fa.classList.add("visible");Ja("Converting...");try{const a=za.value,b=new(window.AudioContext||window.webkitAudioContext)(),c=await qa.arrayBuffer(),d=await b.decodeAudioData(c);if(a==="wav-to-mp3"){const e=d.getChannelData(0),f=d.sampleRate,g=new lamejs.Mp3Encoder(1,f,parseInt(Ba.value)),h=[],i=new Int16Array(e.length);for(let j=0;j<e.length;j++)i[j]=Math.max(-1,Math.min(1,e[j]))*32767;const k=1152;for(let j=0;j<i.length;j+=k){const l=i.subarray(j,j+k),m=g.encodeBuffer(l);if(m.length>0)h.push(m)}const l=g.flush();if(l.length>0)h.push(l);for(let j=0;j<=100;j+=10){Da.style.width=`${j}%`;await new Promise(k=>setTimeout(k,50))}ra=new Blob(h,{type:"audio/mp3"})}else if(a==="mp3-to-wav"){const e=d.numberOfChannels,f=d.sampleRate,g=16,h=d.length*e*(g/8),i=new ArrayBuffer(44+h),j=new DataView(i);j.setUint32(0,0x52494646,false);j.setUint32(4,36+h,true);j.setUint32(8,0x57415645,false);j.setUint32(12,0x666d7420,false);j.setUint32(16,16,true);j.setUint16(20,1,true);j.setUint16(22,e,true);j.setUint32(24,f,true);j.setUint32(28,f*e*(g/8),true);j.setUint16(32,e*(g/8),true);j.setUint16(34,g,true);j.setUint32(36,0x64617461,false);j.setUint32(40,h,true);const k=d.getChannelData(0);for(let l=0;l<k.length;l++)j.setInt16(44+l*2,k[l]*32767,true);for(let l=0;l<=100;l+=10){Da.style.width=`${l}%`;await new Promise(m=>setTimeout(m,50))}ra=new Blob([i],{type:"audio/wav"})}Ha.classList.add("visible");Fa.classList.remove("visible");Ja("Conversion complete!");b.close()}catch(a){Ja(`Error: ${a.message}`,true);Fa.classList.remove("visible");Ca.classList.remove("visible");console.error("Audio error:",a)}}function Ma(){if(!ra)return;const a=URL.createObjectURL(ra),b=document.createElement("a");b.href=a;b.download=`converted.${za.value==="wav-to-mp3"?"mp3":"wav"}`;b.click();URL.revokeObjectURL(a)}function Na(){qa=null;ra=null;ta.value="";va.classList.remove("visible");ya.style.display="none";Ga.disabled=true;Ha.classList.remove("visible");Ca.classList.remove("visible");Da.style.width="0%";Fa.classList.remove("visible");Ja("")}Ga.addEventListener("click",La);Ha.addEventListener("click",Ma);Ia.addEventListener("click",Na)});</script></body></html>